/*!
 * SAP APF Analysis Path Framework
 *
 * (c) Copyright 2012-2014 SAP AG. All rights reserved
 */
jQuery.sap.require("sap.apf.modeler.ui.controller.requestOptions");jQuery.sap.require("sap.apf.modeler.ui.utils.nullObjectChecker");jQuery.sap.require("sap.apf.modeler.ui.utils.optionsValueModelBuilder");(function(){"use strict";var n=sap.apf.modeler.ui.utils.nullObjectChecker;var o=sap.apf.modeler.ui.utils.optionsValueModelBuilder;var t=sap.apf.modeler.ui.utils.textManipulator;sap.apf.modeler.ui.controller.requestOptions.extend("sap.apf.modeler.ui.controller.facetFilterVHR",{setDisplayText:function(){var c=this;var T=c.getView().getViewData().oTextReader;c.byId("idSourceLabel").setText(T("vhSource"));c.byId("idEntityLabel").setText(T("vhEntity"));c.byId("idSelectPropertiesLabel").setText(T("vhSelectProperties"));c.byId("idOptionalRequestFieldLabel").setText(T("ffAlias"));},clearVHRFields:function(e){var c=this;c.clearSource();c.addOrRemoveMandatoryFieldsAndRequiredFlag(false,e);c.setDetailData();},onBeforeRendering:function(){var c=this;var s=new sap.ui.layout.GridData({span:"L6 M6 S6"});c.byId("idOptionalRequestField").setLayoutData(s);c.byId("idOptionalRequestFieldLabel").setVisible(true);c.byId("idOptionalRequestField").setVisible(true);c.byId("idOptionalRequestField").setForceSelection(false);},onAfterRendering:function(){var c=this;c.addOrRemoveMandatoryFieldsAndRequiredFlag(true);},fireRelevantEvents:function(e){var c=this,a;var T=c.getView().getViewData().oTextReader;if(e.getSource()===c.byId("idSource")){c.getView().fireEvent(sap.apf.modeler.ui.utils.CONSTANTS.events.facetFilter.UPDATEPROPERTIES);}if(e.getSource()!==c.byId("idOptionalRequestField")){a=[t.removePrefixText(c.byId("idOptionalRequestField").getSelectedKey(),T(sap.apf.modeler.ui.utils.CONSTANTS.texts.NOTAVAILABLE))];c.updateOptionalRequestFieldProperty(a);}if(c.oParentObject.getUseSameRequestForValueHelpAndFilterResolution()){c.getView().fireEvent(sap.apf.modeler.ui.utils.CONSTANTS.events.facetFilter.USESAMEASVHR);}},setOptionalRequestFieldProperty:function(){var c=this;var a=[],v,f;a=c.byId("idSelectProperties").getSelectedKeys();f=c.oParentObject.getAlias();if(n.checkIsNotNullOrUndefinedOrBlank(f)){v=c.validateSelectedValues(c,[f],a);f=v.aSelectedValues[0];}var m=o.convert(a);c.byId("idOptionalRequestField").setModel(m);c.byId("idOptionalRequestField").setSelectedKey(f);},updateOptionalRequestFieldProperty:function(s){var c=this;c.oParentObject.setAlias(undefined);if(n.checkIsNotNullOrUndefinedOrBlank(s[0])){c.oParentObject.setAlias(s[0]);}},removeOptionalRequestFieldProperty:function(p){var c=this;if(n.checkIsNotNullOrUndefinedOrBlank(p[0])){c.oParentObject.setAlias(undefined);}},addOrRemoveMandatoryFieldsAndRequiredFlag:function(r,e){var c=this;if(r===false&&e===undefined){return;}c.byId("idSourceLabel").setRequired(r);c.byId("idEntityLabel").setRequired(r);c.byId("idSelectPropertiesLabel").setRequired(r);if(r){c.viewValidator.addFields(["idSource","idEntity","idSelectProperties"]);}else{c.viewValidator.removeFields(["idSource","idEntity","idSelectProperties"]);}},getSource:function(){var c=this;return c.oParentObject.getServiceOfValueHelp();},getAllEntitiesAsPromise:function(s){var c=this;return c.oConfigurationEditor.getAllEntitySetsOfServiceAsPromise(s);},getEntity:function(){var c=this;return c.oParentObject.getEntitySetOfValueHelp();},getAllEntitySetPropertiesAsPromise:function(s,e){var c=this;return c.oConfigurationEditor.getAllPropertiesOfEntitySetAsPromise(s,e);},clearSource:function(){var c=this;c.oParentObject.setServiceOfValueHelp(undefined);c.clearEntity();},clearEntity:function(){var c=this;c.oParentObject.setEntitySetOfValueHelp(undefined);c.clearSelectProperties();},clearSelectProperties:function(){var c=this;var O=c.oParentObject.getSelectPropertiesOfValueHelp();O.forEach(function(p){c.oParentObject.removeSelectPropertyOfValueHelp(p);});c.clearOptionalRequestFieldProperty();},removeSelectProperties:function(p){var c=this;p.forEach(function(a){c.oParentObject.removeSelectPropertyOfValueHelp(a);});},clearOptionalRequestFieldProperty:function(){var c=this;c.oParentObject.setAlias(undefined);},updateSource:function(s){var c=this;c.oParentObject.setServiceOfValueHelp(s);},updateEntity:function(e){var c=this;c.oParentObject.setEntitySetOfValueHelp(e);},updateSelectProperties:function(s){var c=this;c.removeSelectProperties(c.oParentObject.getSelectPropertiesOfValueHelp());s.forEach(function(p){c.oParentObject.addSelectPropertyOfValueHelp(p);});},getSelectProperties:function(){var c=this;return c.oParentObject.getSelectPropertiesOfValueHelp();},getOptionalRequestFieldProperty:function(){var c=this;return[c.oParentObject.getAlias()];},getValidationState:function(){var c=this;return c.viewValidator.getValidationState();}});}());
