/*!
* SAP APF Analysis Path Framework
*
* (c) Copyright 2012-2014 SAP AG. All rights reserved
*/
sap.ui.define(["sap/apf/modeler/ui/utils/constants","sap/apf/modeler/ui/utils/propertyTypeOrchestration"],function(m,p){'use strict';var S=function(P,o,s,t){this.oParentView=P;this.oStepPropertyMetadataHandler=s;this.oParentObject=o;this.oTextReader=t;};function c(s,t,P){var v;var o=new p.PropertyTypeOrchestration();var V={oConfigurationEditor:s.oParentView.getViewData().oConfigurationEditor,oParentObject:s.oParentObject,oCoreApi:s.oParentView.getViewData().oCoreApi,oConfigurationHandler:s.oParentView.getViewData().oConfigurationHandler,oStepPropertyMetadataHandler:s.oStepPropertyMetadataHandler,sPropertyType:t};var a={oViewDataForPropertyType:V,aPropertiesToBeCreated:P,oPropertyOrchestration:o};v=new sap.ui.view({viewName:"sap.apf.modeler.ui.view.propertyTypeHandler",type:sap.ui.core.mvc.ViewType.XML,id:s.oParentView.getController().createId("id"+t),viewData:a});s.oParentView.getController().byId("idSortLayout").insertItem(v);s.oParentView.attachEvent(m.events.step.SETTOPNPROPERTIES,v.getController().handleSettingTopNProperties.bind(v.getController()));}function _(s){var P=[];s.forEach(function(o){P.push({sProperty:o.property,sContext:o.ascending?"true":"false"});});return P;}S.prototype.instantiateRepresentationSortData=function(){var r=_(this.oParentObject.getOrderbySpecifications());if(r.length===0){r=[{sProperty:this.oTextReader("none"),sContext:"true"}];}c(this,m.propertyTypes.REPRESENTATIONSORT,r);};S.prototype.instantiateStepSortData=function(){var r;this.destroySortData();if(this.oParentObject.getTopN()&&this.oParentObject.getTopN().orderby.length!==0){r=_(this.oParentObject.getTopN().orderby);}else{r=[{sProperty:this.oStepPropertyMetadataHandler.getProperties()[0],sContext:"true"}];}c(this,m.propertyTypes.STEPSORT,r);};S.prototype.destroySortData=function(){this.oParentView.getController().byId("idSortLayout").destroyItems();};return S;},true);
