/*!
 * SAP APF Analysis Path Framework
 * 
 * (c) Copyright 2012-2014 SAP AG. All rights reserved
 */
jQuery.sap.declare("sap.apf.core.metadataFactory");(function(){'use strict';sap.apf.core.MetadataFactory=function(i){this.type="metadataFactory";var m=i.instances.messageHandler;var H=i.constructors.Hashtable;var M=i.constructors.Metadata;var E=i.constructors.EntityTypeMetadata;var a=i.constructors.MetadataFacade;delete i.constructors.Metadata;delete i.constructors.EntityTypeMetadata;delete i.constructors.MetadataFacade;delete i.instances.configurationFactory;var b=new H(m);this.getMetadata=function(p){if(b.hasItem(p)===false){b.setItem(p,{metadataPromise:new M(i,p).isInitialized()});}return b.getItem(p).metadataPromise;};this.getEntityTypeMetadata=function(p,e){var c;var d;var f=this.getMetadata(p);c=b.getItem(p).entityTypes;if(!c){c=new H(m);b.getItem(p).entityTypes=c;}if(!c.getItem(e)){d=jQuery.Deferred();c.setItem(e,d.promise());f.then(function(g){d.resolve(new E(m,e,g));},function(){d.resolve(undefined);});}return c.getItem(e);};this.getMetadataFacade=function(p){return new a({constructors:{MetadataProperty:i.constructors.MetadataProperty},instances:{messageHandler:m,metadataFactory:this}},p);};this.getServiceDocuments=function(){return i.functions.getServiceDocuments();};this.getEntitySets=function(s){var d=jQuery.Deferred();this.getMetadata(s).done(function(c){d.resolve(c.getEntitySets());}).fail(function(){d.resolve([]);});return d.promise();};this.getAllEntitySetsExceptParameterEntitySets=function(s){var d=jQuery.Deferred();this.getMetadata(s).done(function(c){d.resolve(c.getAllEntitySetsExceptParameterEntitySets());}).fail(function(){d.resolve([]);});return d.promise();};this.getEntityTypes=function(s){var d=jQuery.Deferred();this.getMetadata(s).done(function(c){d.resolve(c.getEntityTypes());}).fail(function(){d.resolve([]);});return d.promise();};};}());
