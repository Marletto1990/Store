/*!
 * SAP APF Analysis Path Framework
 * 
 * (c) Copyright 2012-2015 SAP SE. All rights reserved
 */
sap.ui.define(["sap/apf/core/constants","sap/apf/utils/utils","sap/ui/model/Filter"],function(c,u,U){'use strict';var F=function(m,p,o,v,h){this.type="filterTerm";this.propertyName=p;this.operator=o;this.value=v;this.highValue=h;this.messageHandler=m;if(this.operator.length==2){this.operator=this.operator.toUpperCase();}m.check(this.operator!==undefined,"sap.apf.utils.FilterTerm.constructor operator undefined");m.check(jQuery.inArray(this.operator,c.aSelectOpt)>-1,"sap.apf.core.utils.FilterTerm operator "+this.operator+" not supported");m.check(this.propertyName!==undefined,"sap.apf.utils.core.FilterTerm propertyName undefined");m.check(this.value!==undefined,"sap.apf.utils.FilterTerm value undefined");};F.prototype.isConsistentWithFilter=function(p,v){var a;var i;if(p!==this.propertyName){return true;}if(this.operator===c.FilterOperators.EQ){if(this.value instanceof Date&&v instanceof Date){return(this.value.valueOf()===v.valueOf());}return(this.value===v);}else if(this.operator===c.FilterOperators.LT){if(this.value instanceof Date&&v instanceof Date){return(this.value.valueOf()>v.valueOf());}return(this.value>v);}else if(this.operator===c.FilterOperators.LE){if(this.value instanceof Date&&v instanceof Date){return(this.value.valueOf()>=v.valueOf());}return(this.value>=v);}else if(this.operator===c.FilterOperators.GT){if(this.value instanceof Date&&v instanceof Date){return(this.value.valueOf()<v.valueOf());}return(this.value<v);}else if(this.operator===c.FilterOperators.BT){if(this.value instanceof Date&&v instanceof Date){return(this.value.valueOf()<=v.valueOf()&&v.valueOf()<=this.highValue.valueOf());}return(this.value<=v&&v<=this.highValue);}else if(this.operator===c.FilterOperators.GE){if(this.value instanceof Date&&v instanceof Date){return(this.value.valueOf()<=v.valueOf());}return(this.value<=v);}else if(this.operator===c.FilterOperators.NE){if(this.value instanceof Date&&v instanceof Date){return!(this.value.valueOf()===v.valueOf());}return!(this.value===v);}else if(this.operator===c.FilterOperators.StartsWith){if(this.value.length>v.length){return false;}a=v.slice(0,this.value.length);return(a===this.value);}else if(this.operator===c.FilterOperators.EndsWith){if(this.value.length>v.length){return false;}a=v.slice(-this.value.length);return(a===this.value);}else if(this.operator===c.FilterOperators.Contains){i=v.indexOf(this.value);return(i>-1);}};F.prototype.toUrlParam=function(a){var s="'";var b=" ";var p="";var v,h;if(a&&a.formatValue){v=a.formatValue(this.propertyName,this.value);if(this.highValue){h=a.formatValue(this.propertyName,this.highValue);}}else{if(typeof this.value==='number'){v=this.value;}else{v=s+u.escapeOdata(this.value)+s;}if(this.highValue){if(typeof this.value==='number'){h=this.highValue;}else{h=s+u.escapeOdata(this.highValue)+s;}}}if(this.operator===c.FilterOperators.StartsWith){p='startswith('+u.escapeOdata(this.propertyName)+','+v+')';p=jQuery.sap.encodeURL(p);}else if(this.operator===c.FilterOperators.EndsWith){p='endswith('+u.escapeOdata(this.propertyName)+','+v+')';p=jQuery.sap.encodeURL(p);}else if(this.operator===c.FilterOperators.Contains){p='substringof('+v+','+u.escapeOdata(this.propertyName)+')';p=jQuery.sap.encodeURL(p);}else if(this.operator===c.FilterOperators.BT){p='(('+jQuery.sap.encodeURL(u.escapeOdata(this.propertyName)+b+"ge"+b+v)+')'+jQuery.sap.encodeURL(b+'and'+b)+'('+jQuery.sap.encodeURL(u.escapeOdata(this.propertyName)+b+"le"+b+h)+'))';}else{p='('+jQuery.sap.encodeURL(u.escapeOdata(this.propertyName)+b+this.operator.toLowerCase()+b+v)+')';}return p;};F.prototype.getProperty=function(){return this.propertyName;};F.prototype.getOp=function(){return this.operator;};F.prototype.getValue=function(){return this.value;};F.prototype.getHighValue=function(){return this.highValue;};F.prototype.getHash=function(){var s=this.propertyName+this.operator+this.value;if(this.highValue){s+=this.highValue;}return u.hashCode(s);};F.prototype.copy=function(){return new F(this.messageHandler,this.propertyName,this.operator,this.value,this.highValue);};F.prototype.removeTermsByProperty=function(p){return this.internalRemoveTermsByProperty(p);};F.prototype.internalRemoveTermsByProperty=function(p){var i=0;var l=0;if(p instanceof Array){l=p.length;for(i=0;i<l;i++){if(this.propertyName===p[i]){return undefined;}}return this.copy();}if(this.propertyName===p){return undefined;}return this.copy();};F.prototype.removeTerms=function(p,o,v){var i=0;var l=0;if(p instanceof Array){l=p.length;for(i=0;i<l;i++){if(this.propertyName===p[i]&&this.operator===o&&this.value===v){return undefined;}}return this.copy();}if(this.propertyName===p&&this.operator===o&&this.value===v){return undefined;}return this.copy();};F.prototype.mapToSapUI5FilterExpression=function(){if(this.operator===c.FilterOperators.BT){return new U({path:this.propertyName,operator:this.operator,value1:this.value,value2:this.highValue});}return new U({path:this.propertyName,operator:this.operator,value1:this.value});};F.prototype.traverse=function(v){return v.processTerm(this);};sap.apf.core.utils.FilterTerm=F;return F;},true);
