/*!
* SAP APF Analysis Path Framework
* 
 * (c) Copyright 2012-2018 SAP SE. All rights reserved
*/
sap.ui.define(['sap/ui/core/mvc/Controller','sap/ui/model/odata/ODataUtils','sap/ui/model/odata/v2/ODataModel','sap/ui/model/odata/CountMode'],function(B,O,a,C){'use strict';return B.extend("sap.apf.ui.reuse.controller.smartFilterBar",{onInit:function(){var c=this;var s=c.getView().getViewData().oSmartFilterBarConfiguration.service;var b=c.getView().getViewData().oCoreApi.getAnnotationsForService(s);var p={annotationURI:b,json:true};if(b&&b.length>0){p.loadAnnotationsJoined=true;}var d=c.getView().getViewData().oCoreApi.getStartParameterFacade().getSapSystem();if(d){s=O.setOrigin(s,{force:true,alias:d});}var m=new a(s,p);m.getMetaModel().loaded().then(function(){c.getView().getViewData().oCoreApi.getMetadata(s).done(function(e){if(e.getAllEntitySetsExceptParameterEntitySets().indexOf(c.getView().getViewData().oSmartFilterBarConfiguration.entitySet)<0){c.getView().getViewData().oCoreApi.putMessage(c.getView().getViewData().oCoreApi.createMessageObject({code:"5053",aParameters:[c.getView().getViewData().oSmartFilterBarConfiguration.entitySet,s]}));}m.setDefaultCountMode(C.None);c.byId("idAPFSmartFilterBar").setModel(m);});});m.attachMetadataFailed(function(){c.getView().getViewData().oCoreApi.putMessage(c.getView().getViewData().oCoreApi.createMessageObject({code:"5052",aParameters:[s]}));});},afterInitialization:function(){this.validateFilters();this.registerSFBInstanceWithCore();},registerSFBInstanceWithCore:function(){var c=this;c.getView().getViewData().oCoreApi.registerSmartFilterBarInstance(c.byId("idAPFSmartFilterBar"));},handlePressOfGoButton:function(){var c=this;var s=this.byId("idAPFSmartFilterBar");if(!s._apfOpenPath&&c.getView().getViewData().oCoreApi.getActiveStep()){c.getView().getViewData().oUiApi.selectionChanged(true);}delete s._apfOpenPath;},validateFilters:function(){var s=this.byId("idAPFSmartFilterBar");var v=s.validateMandatoryFields();this.getView().getViewData().oUiApi.getAddAnalysisStepButton().setEnabled(v);this.getView().getViewData().oUiApi.getAddAnalysisStepButton().rerender();}});});
