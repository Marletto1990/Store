/*!
 * SAP APF Analysis Path Framework
 *
 * (c) Copyright 2012-2018 SAP SE. All rights reserved
 */
sap.ui.define(['sap/ui/core/mvc/Controller'],function(B){"use strict";return B.extend("sap.apf.ui.reuse.controller.analysisPath",{refreshAnalysisPath:function(){this.getView().getCarousel().getController().refreshCarousel();},isOpenPath:false,isNewPath:false,isBackNavigation:false,bLastValidState:false,onInit:function(){this.oCoreApi=this.getView().getViewData().oCoreApi;this.oUiApi=this.getView().getViewData().uiApi;if(sap.ui.Device.system.desktop){this.getView().addStyleClass("sapUiSizeCompact");}},refresh:function(n){var v=this.getView().oCarousel;var s=v.stepViews;var i;if(n!==-1){for(i=n;i<s.length;i++){var S={};S=s[i];if(S!==undefined){S.oThumbnailChartLayout.setBusy(true);}}}var a=this.oCoreApi.getSteps().indexOf(this.oCoreApi.getActiveStep());if(a>n){var c=this.oUiApi.getStepContainer();c.stepLayout.setBusy(true);}if(!this.oCoreApi.isDirty()&&this.oCoreApi.getSteps().length!==0){this.oCoreApi.setDirtyState(true);this.setPathTitle();}},setPathTitle:function(){var p=this.oCoreApi.getPathName();if(p.length==0){p=this.oCoreApi.getTextNotHtmlEncoded("unsaved");}if(this.oCoreApi.isDirty()){p='*'+p;}this.oUiApi.getAnalysisPath().oSavedPathName.setTitle(p);this.oUiApi.getAnalysisPath().oSavedPathName.setTooltip(p);},callBackForUpdatePath:function(c,s){var n=this.oCoreApi.getSteps().indexOf(c);if(n===0){this.refreshAnalysisPath();}this.updateCurrentStep(c,n,s);},callBackForUpdatePathAndSetLastStepAsActive:function(c,s){var n=this.oCoreApi.getSteps().indexOf(c);if(n===0){var S=this.oCoreApi.getSteps()[this.oCoreApi.getSteps().length-1];this.oCoreApi.setActiveStep(S);this.refreshAnalysisPath();}this.updateCurrentStep(c,n,s);this.oUiApi.getLayoutView().setBusy(false);},updateCurrentStep:function(c,n,s){var a=this.oCoreApi.getSteps().indexOf(this.oCoreApi.getActiveStep());var i=(n===a);this.drawThumbnail(n,s||this.isOpenPath);if(i){this.drawMainChart(s);}if(this.isOpenPath&&(this.oCoreApi.getSteps().indexOf(c)===(this.oCoreApi.getSteps().length-1))){this.oUiApi.getLayoutView().setBusy(false);this.isOpenPath=false;}if(this.isBackNavigation&&(this.oCoreApi.getSteps().indexOf(c)===(this.oCoreApi.getSteps().length-1))){this.oUiApi.getLayoutView().setBusy(false);this.isBackNavigation=false;}if(this.bLastValidState&&(this.oCoreApi.getSteps().indexOf(c)===(this.oCoreApi.getSteps().length-1))){this.oUiApi.getLayoutView().setBusy(false);this.bLastValidState=false;}this.isNewPath=false;},drawMainChart:function(s){var c=this.oUiApi.getStepContainer();c.getController().drawStepContent(s);},drawThumbnail:function(n,s){var S=this.getView().getCarousel().getStepView(n);S.getController().drawThumbnailContent(s);},navigateToStep:function(i){this.getView().getCarousel().getStepView(i).getController().setActiveStep(i);},apfDestroy:function(){this.getView().getToolbar().getController().apfDestroy();this.getView().getCarousel().getController().apfDestroy();}});});
