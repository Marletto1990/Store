jQuery.sap.declare("sap.apf.ui.utils.determineColumnSettingsForSpreadSheetExport");jQuery.sap.require("sap.ui.export.Spreadsheet");(function(){"use strict";sap.apf.ui.utils.determineColumnSettingsForSpreadSheetExport=function(p,m){var e={};var a,u;if(m){a=m.getPropertyMetadata(p);var b=a.dataType.type;if(b==="Edm.Int32"){e.type=sap.ui.export.EdmType.Number;e.scale=0;}else if(b==="Edm.Decimal"){e.type=sap.ui.export.EdmType.Number;e.precision=parseInt(a.precision,10);e.scale=parseInt(a.scale,10);if(a["sap:unit"]){u=m.getPropertyMetadata(a["sap:unit"]);if(u&&u["sap:semantics"]&&u["sap:semantics"]==="currency-code"){e.type=sap.ui.export.EdmType.Currency;e.unitProperty=u.name;e.displayUnit=true;}}}else if(b==="Edm.DateTime"){if(a["sap:display-format"]&&a["sap:display-format"]==="Date"){e.type=sap.ui.export.EdmType.Date;}else{e.type=sap.ui.export.EdmType.DateTime;}}else if(b==="Edm.DateTimeOffset"){e.type=sap.ui.export.EdmType.DateTime;}else if(b==="Edm.String"){e.type=sap.ui.export.EdmType.String;if(a.MaxLength){e.width=parseInt(a.MaxLength,10);}}else{e.type=sap.ui.export.EdmType.String;}}return e;};}());
