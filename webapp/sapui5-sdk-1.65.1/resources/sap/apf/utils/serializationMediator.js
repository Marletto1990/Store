/*!
 * SAP APF Analysis Path Framework
 * 
 * (c) Copyright 2012-2014 SAP AG. All rights reserved
 */
sap.ui.define(["sap/apf/core/constants"],function(c){'use strict';var S=function(i){this.savePath=function(a,b,d){this.serialize(false).done(function(s){if(typeof a==='string'&&typeof b==='function'){i.instances.coreApi.savePath(a,b,s);}else if(typeof a==='string'&&typeof b==='string'&&typeof d==='function'){i.instances.coreApi.savePath(a,b,d,s);}});};this.openPath=function(p,a,b){i.instances.coreApi.openPath(p,d.bind(this));function d(r,m,e){i.instances.coreApi.resetPath();i.instances.messageHandler.setCallbackForTriggeringFatal(f);this.deserialize(r.path.SerializedAnalysisPath,b).done(function(){i.instances.messageHandler.setCallbackForTriggeringFatal(undefined);a({},m);});function f(e){if(e.getSeverity()!==c.message.severity.warning){var g=i.instances.messageHandler.createMessageObject({code:'5210'});g.setPrevious(e);i.instances.messageHandler.putMessage(g);}}}};this.deletePath=function(p,C){i.instances.coreApi.deletePath(p,C);};this.readPaths=function(C){i.instances.coreApi.readPaths(C);};this.serialize=function(a,k){var r=jQuery.Deferred();var s={};i.instances.startFilterHandler.serialize(undefined,k).done(function(b){var d=i.instances.coreApi.serialize();s.startFilterHandler=b;s.filterIdHandler=i.instances.filterIdHandler.serialize();s.path=d.path;s.smartFilterBar=d.smartFilterBar;if(a){s.pathName=i.instances.coreApi.getPathName();s.dirtyState=i.instances.coreApi.isDirty();}r.resolve(s);});return r;};this.deserialize=function(s,a){var d=jQuery.Deferred();var b;if(s.dirtyState!==undefined){i.instances.coreApi.setDirtyState(s.dirtyState);}if(s.pathName!==undefined){i.instances.coreApi.setPathName(s.pathName);}b={path:s.path,smartFilterBar:s.smartFilterBar};if(a!==undefined){b.path.indicesOfActiveSteps[0]=a;}i.instances.coreApi.getApplicationConfigProperties().done(function(){i.instances.coreApi.deserialize(b);i.instances.filterIdHandler.deserialize(s.filterIdHandler);i.instances.startFilterHandler.getStartFilters().done(function(){if(s.startFilterHandler){i.instances.startFilterHandler.deserialize(s.startFilterHandler).done(function(){d.resolve();});}else{d.resolve();}});});return d.promise();};};sap.apf.utils.SerializationMediator=S;return S;},true);
